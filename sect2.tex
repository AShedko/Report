\section{Модификация проекта «Интерпретатор арифметических выражений»}

\subsection{Постановка задачи}
Вычисляются значения выражений, содержащих битовые операции  \verb|<<| и \verb|>>|,
приоритет первой из которых является минимальным, а второй — максимальным.

\subsection{Теоретические аспекты}
Если компилятор осуществляет перевод с одного языка на другой, то интерпретатор
\emph{вычисляет} значение арифметической формулы, в которой вместо имён переменных
содержатся записанные тем или иным способом числа.

Грамматика $G_0$ из предыдущего пункта должна быть изменена для учёта максимального приоритета операции сдвига вправо:

$G_0$:
\medskip
\noindent\hspace{2cm}
\begin{tabular}{rcccccll}
\verb|S_0| $\rightarrow$ & \verb|F| &$\mid$&\verb|S_0LF|\\
\verb|F| $\rightarrow$ & \verb|T| &$\mid$&\verb|F+T|&$\mid$&\verb|F-T|\\
\verb|T| $\rightarrow$ & \verb|M| &$\mid$&\verb|T*M|&$\mid$&\verb|T/M|\\
\verb|S_1| $\rightarrow$ & \verb|M| &$\mid$& \verb|S_1RF|\\
\verb|M| $\rightarrow$ & \verb|(S_0)|&$\mid$&\verb|V|\\
\verb|V| $\rightarrow$ & a &$\mid$& b &$\mid$& \dots &$\mid$& z\\
\end{tabular}
\medskip

\noindent{\verb|S_0|~--- класс сдвигаемых влево выражений;\newline
\verb|S_1|~--- класс сдвигаемых вправо выражений.}

$G_s$ можно оставить без изменений.

Класс \verb|Calc|, реализующий алгоритм интерпретации арифметических выражений 
может быть построен при помощи уже реализованного класса \verb|Compf|.

Интерпретатор выражений отличается от компилятора тем, что
вместо идентификаторов переменных во входной формуле стоят \emph{числа} и
получаемую выходную формулу необходимо \emph{выполнять} (вместо её печати).
Для того чтобы реализовать стековый калькулятор, естественно, необходим стек.

При появлении на входе цифры, будем помещать её в стек калькулятора \verb|@s|,
а при появлении операции доставать из стека её аргументы и помещать туда результат
её выполнения. На конечном этапе на вершине стека будет находиться результат
выполнения арифметического выражения.

\subsection{Детали реализации}

Здесь также как и в первом проекте применена хеш-таблица для отображения множества
операций стекового компилятора в множество операций языка Ruby.
\begin{lstlisting}
CONV_TABLE = {"R" => ">>",
              "L" => "<<",
              "+" => "+",
              "-" => "-",
              "/" => "/",
              "*" => "*"}
\end{lstlisting}
В соответствии с задачей, приоритет операций был изменён следующим образом:
\begin{lstlisting}
  def priority(c)
    (c == '+' or c == '-') ? 1 : c=='L' ? 0 : (c=='R') ? 3 : 2
  end
\end{lstlisting}
\begin{table}[ht!]
\caption{Приоритет операций}
\begin{center}
\begin{tabular}{|c|c|}
\hline
Операция & Приоритет \\
\hline
\verb|L| & $0$ \\
\hline
\verb|+, -| & $1$ \\
\hline
\verb|*, /| & $2$ \\
\hline
\verb|R| & $3$ \\
\hline
\end{tabular}
\end{center}
\end{table}

